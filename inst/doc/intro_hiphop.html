<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>intro_hiphop</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">intro_hiphop</h1>



<div id="authors" class="section level3">
<h3>Authors</h3>
<p>Martijn van de Pol, Lyanne Brouwer and Andrew Cockburn - 11 August 2020</p>
</div>
<div id="what-is-r-package-hiphop-for" class="section level2">
<h2>What is R package hiphop for?</h2>
<p>R package hiphop is a method for parentage assignment using bi-allelic genetic markers like SNPs (Single Nucleotide Polymorphism). It has widespread application (paternity and maternity assignment in a variety of mating systems) and outperforms conventional methods where closely related individuals occur in the pool of possible parents. The method is based on simple exclusion logic by comparing the genotypes of offspring with those of potentials parents using the HIPHOP and HOT test; the rationale behind this paternity assignment method is described in detail in Cockburn et al. (for full reference use citation(“hiphop”)). Here we explain how it can be used with worked examples based on the data set that are used in the above paper and are included in the hiphop package.</p>
<div id="the-basic-idea" class="section level3">
<h3>The basic idea</h3>
<p>The basic idea behind the HIPHOP parentage assignment is that we can compare the genotypes of any combination of offspring with potentials dams and sires (i.e. genetic mother or fathers) by comparing the exclusion scores of these individuals at bi-allelic markers. It elaborates on a prior exclusion method based on the Homozygous Opposite Test (HOT; Huisman 2017; <a href="https://doi.org/10.1111/1755-0998.12665" class="uri">https://doi.org/10.1111/1755-0998.12665</a>). HOT compares the genotype of an offspring with a potential parent: a mismatch is scored when both the offspring and parent are homozygous, but for different alleles. Cockburn et al. suggested an additional -and as we will later see more informative- exclusion criterion called HIPHOP (Homozygous Identical Parents, Heterozygous Offspring are Precluded). This test compares the genotype of an offspring with both potential parents: a mismatch is scored when the offspring is heterozygous and both parents are homozygous for the same allele. Furthermore, although the HOT test was originally designed to compare the genotypes of offspring with one parent (a dyad), it can easily be extended to also compare offspring to both parents (a triad, similar to the HIPHOP test that also compares triads): a mismatch is scored when the offspring is homozygous and at least one of the parents is homozygous for the opposite allele (i.e. the HOT.parents test). The HOT and HIPHOP scores of triads can be combined to provide information about the total of mismatches and is proposed as an improved exclusion criterion for parentage assignment, particularly when distinguishing between closely related potential parents.</p>
<p>Below mismatch table shows all possible combinations of bi-allelic genotypes of offspring-dam-sire combinations for a single locus and which combinations of genotypes are indicative of a mismatch (the R code also illustrates the basic calculations). The total number of mismatches (also called the ‘HOTHIPHOP.parents’ mismatch score) is the sum of the HOT scores of the offspring with the parents (HOT.parents) and the HIPHOP score with the potential parents (offspring-dam-sire triad). Mismatches may occur because (a) the potential dam and/or sire is not the true genetic parent, (b) genotyping errors, and (c) mutations. We are aiming to exclude potential parents by determining if they have more mismatches than can be expected due to genotyping errors and mutation, and thereby identify (i) the true genetic parents and (ii) detect situations where one (or both) of the true parents is not sampled, in which case we (iii) want to identify which parent can still be correctly assigned.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>genotyp&lt;-<span class="kw">c</span>(<span class="st">&quot;AA&quot;</span>, <span class="st">&quot;Aa&quot;</span>, <span class="st">&quot;aa&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>gentable.names&lt;-<span class="kw">c</span>(<span class="st">&quot;offspring&quot;</span>,<span class="st">&quot;dam&quot;</span>,<span class="st">&quot;sire&quot;</span>,<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hot.sire&quot;</span>,<span class="st">&quot;hot.parents&quot;</span>, <span class="st">&quot;hiphop&quot;</span>,<span class="st">&quot;hothiphop.parents&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a>gentable&lt;-<span class="kw">as.data.frame</span>(<span class="kw">array</span>(<span class="ot">NA</span>,<span class="dt">dim =</span> <span class="kw">c</span>(<span class="kw">length</span>(genotyp)<span class="op">^</span><span class="dv">3</span>,<span class="kw">length</span>(gentable.names)), <span class="dt">dimnames=</span><span class="kw">list</span>(<span class="ot">NULL</span>,gentable.names)))</span>
<span id="cb1-4"><a href="#cb1-4"></a>gentable<span class="op">$</span>offspring&lt;-<span class="kw">rep</span>(genotyp, <span class="dt">each=</span><span class="kw">length</span>(genotyp)<span class="op">*</span><span class="kw">length</span>(genotyp))</span>
<span id="cb1-5"><a href="#cb1-5"></a>gentable<span class="op">$</span>dam&lt;-<span class="kw">rep</span>(genotyp, <span class="kw">length</span>(genotyp)<span class="op">*</span><span class="kw">length</span>(genotyp))</span>
<span id="cb1-6"><a href="#cb1-6"></a>gentable<span class="op">$</span>sire&lt;-<span class="kw">rep</span>(genotyp, <span class="kw">length</span>(genotyp), <span class="dt">each=</span><span class="kw">length</span>(genotyp))</span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># the HOT test for the offspring-dam dyad</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>gentable<span class="op">$</span>hot.dam&lt;-<span class="kw">ifelse</span>( (gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;AA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>dam<span class="op">==</span><span class="st">&quot;aa&quot;</span>) <span class="op">|</span><span class="st"> </span>(gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;aa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>dam<span class="op">==</span><span class="st">&quot;AA&quot;</span>), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># the HOT test for the offspring-sire dyad </span></span>
<span id="cb1-10"><a href="#cb1-10"></a>gentable<span class="op">$</span>hot.sire&lt;-<span class="kw">ifelse</span>( (gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;AA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>sire<span class="op">==</span><span class="st">&quot;aa&quot;</span>) <span class="op">|</span><span class="st"> </span>(gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;aa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>sire<span class="op">==</span><span class="st">&quot;AA&quot;</span>), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co"># the HOT test for the offspring-dam-sire triad</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>gentable<span class="op">$</span>hot.parents&lt;-<span class="kw">ifelse</span>(((gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;AA&quot;</span> <span class="op">&amp;</span><span class="st"> </span>(gentable<span class="op">$</span>sire<span class="op">==</span><span class="st">&quot;aa&quot;</span> <span class="op">|</span><span class="st"> </span>gentable<span class="op">$</span>dam<span class="op">==</span><span class="st">&quot;aa&quot;</span>)) <span class="op">|</span><span class="st"> </span>(gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;aa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>(gentable<span class="op">$</span>sire<span class="op">==</span><span class="st">&quot;AA&quot;</span> <span class="op">|</span><span class="st"> </span>gentable<span class="op">$</span>dam<span class="op">==</span><span class="st">&quot;AA&quot;</span>))),<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># the hiphop for the dam-sire combination</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>gentable<span class="op">$</span>hiphop&lt;-<span class="kw">ifelse</span>( (gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;Aa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>sire<span class="op">==</span><span class="st">&quot;aa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>dam<span class="op">==</span><span class="st">&quot;aa&quot;</span>) <span class="op">|</span><span class="st"> </span>(gentable<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;Aa&quot;</span> <span class="op">&amp;</span><span class="st"> </span>gentable<span class="op">$</span>sire<span class="op">==</span><span class="st">&quot;AA&quot;</span> <span class="op">&amp;</span><span class="st">  </span>gentable<span class="op">$</span>dam<span class="op">==</span><span class="st">&quot;AA&quot;</span>), <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb1-15"><a href="#cb1-15"></a>gentable<span class="op">$</span>hothiphop.parents&lt;-gentable<span class="op">$</span>hot.parents<span class="op">+</span>gentable<span class="op">$</span>hiphop</span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="kw">print</span>(gentable)</span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt;    offspring dam sire hot.dam hot.sire hot.parents hiphop hothiphop.parents</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">#&gt; 1         AA  AA   AA       0        0           0      0                 0</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">#&gt; 2         AA  Aa   AA       0        0           0      0                 0</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">#&gt; 3         AA  aa   AA       1        0           1      0                 1</span></span>
<span id="cb1-21"><a href="#cb1-21"></a><span class="co">#&gt; 4         AA  AA   Aa       0        0           0      0                 0</span></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co">#&gt; 5         AA  Aa   Aa       0        0           0      0                 0</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="co">#&gt; 6         AA  aa   Aa       1        0           1      0                 1</span></span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="co">#&gt; 7         AA  AA   aa       0        1           1      0                 1</span></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co">#&gt; 8         AA  Aa   aa       0        1           1      0                 1</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="co">#&gt; 9         AA  aa   aa       1        1           1      0                 1</span></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co">#&gt; 10        Aa  AA   AA       0        0           0      1                 1</span></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="co">#&gt; 11        Aa  Aa   AA       0        0           0      0                 0</span></span>
<span id="cb1-29"><a href="#cb1-29"></a><span class="co">#&gt; 12        Aa  aa   AA       0        0           0      0                 0</span></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co">#&gt; 13        Aa  AA   Aa       0        0           0      0                 0</span></span>
<span id="cb1-31"><a href="#cb1-31"></a><span class="co">#&gt; 14        Aa  Aa   Aa       0        0           0      0                 0</span></span>
<span id="cb1-32"><a href="#cb1-32"></a><span class="co">#&gt; 15        Aa  aa   Aa       0        0           0      0                 0</span></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="co">#&gt; 16        Aa  AA   aa       0        0           0      0                 0</span></span>
<span id="cb1-34"><a href="#cb1-34"></a><span class="co">#&gt; 17        Aa  Aa   aa       0        0           0      0                 0</span></span>
<span id="cb1-35"><a href="#cb1-35"></a><span class="co">#&gt; 18        Aa  aa   aa       0        0           0      1                 1</span></span>
<span id="cb1-36"><a href="#cb1-36"></a><span class="co">#&gt; 19        aa  AA   AA       1        1           1      0                 1</span></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="co">#&gt; 20        aa  Aa   AA       0        1           1      0                 1</span></span>
<span id="cb1-38"><a href="#cb1-38"></a><span class="co">#&gt; 21        aa  aa   AA       0        1           1      0                 1</span></span>
<span id="cb1-39"><a href="#cb1-39"></a><span class="co">#&gt; 22        aa  AA   Aa       1        0           1      0                 1</span></span>
<span id="cb1-40"><a href="#cb1-40"></a><span class="co">#&gt; 23        aa  Aa   Aa       0        0           0      0                 0</span></span>
<span id="cb1-41"><a href="#cb1-41"></a><span class="co">#&gt; 24        aa  aa   Aa       0        0           0      0                 0</span></span>
<span id="cb1-42"><a href="#cb1-42"></a><span class="co">#&gt; 25        aa  AA   aa       1        0           1      0                 1</span></span>
<span id="cb1-43"><a href="#cb1-43"></a><span class="co">#&gt; 26        aa  Aa   aa       0        0           0      0                 0</span></span>
<span id="cb1-44"><a href="#cb1-44"></a><span class="co">#&gt; 27        aa  aa   aa       0        0           0      0                 0</span></span></code></pre></div>
</div>
</div>
<div id="parentage-analysis-single-parent-versus-parent-pair-assignment." class="section level2">
<h2>Parentage analysis: single parent versus parent pair assignment.</h2>
<p>Parentage analysis typically comes in two forms:</p>
<div id="parentage-assignment-when-one-genetic-parent-is-known-single-parent-analysis" class="section level3">
<h3>1. Parentage assignment when one genetic parent is known: single parent analysis</h3>
<p>In the conventional case of parentage analysis there is usually contextual information that provides evidence about the identity of one of the genetic parents. The most common case will be where a female has been observed to be involved in reproductive tasks (built a nest, laid or incubated the eggs, lactated young). For the male parent we typically cannot make this assumption, because contextual evidence for paternity is usually less obvious and promiscuity means that paternity is often uncertain and needs to assessed (though in some species with sex role reversal, it may be possible to condition on the social father and focus on maternity assignment).</p>
</div>
<div id="parentage-assignment-when-no-genetic-parents-are-known-parent-pair-analysis" class="section level3">
<h3>2. Parentage assignment when no genetic parents are known: parent pair analysis</h3>
<p>In other systems we have no or little contextual information about either of the social parents, in which case we can make no a priori assumptions about the genetic parents. In such cases the aim is to assign both the genetic mother (dam) and genetic father (sire) and perform a parent pair analysis. Such cases occur when: (a) Communal spawning: some animals with external fertilisation that breed in aggregations so that it is impossible to know which female laid eggs (e.g. frogs in leks, some fish) and which male fertilized the eggs, as there are no permanent social groups. (b) Polygynandry: multiple females and males breed and deposit their young in a common burrrow or nest (e.g. acorn woodpeckers, Eurasian badgers), which may be difficult to observe so individual offspring cannot be associated with a single parent. There may also be extra-group mating (as has been argued for chimpanzees and Australian magpies).</p>
</div>
</div>
<div id="how-does-it-work" class="section level2">
<h2>How does it work?</h2>
<p>R package hiphop includes three functions and an example dataset consisting of two input dataframes based on five cohorts (2014-2018) of superb fairy wrens living in Canberra, Australia.</p>
<p>We first load the library.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(hiphop)</span></code></pre></div>
</div>
<div id="example-dataset" class="section level2">
<h2>Example dataset</h2>
<p>The superb fairy wren case reflects the first case described above, as there is a social pair, in which previous evidence has shown that the female that incubates the eggs (the social mother) is always the dam. However, the social male is generally not the sire, as the rate of extra-pair paternity is among the highest recorded in bird species. Furthermore, besides the male that is pair bonded to the social mother (the social father), each group contains supernumerary males that sometimes also gain paternity (there is within- and extra-group paternity). Finally, superb fairy wrens have very limited dispersal, almost all males live their entire life on their natal or a neighouring territory, and as a consequence paternity assignment thus faces the challenge of distinguishing between closely related potential sires (e.g. first order relatives).</p>
<p>In the next sections we will first use the example dataset to illustrate the workings of the functions in package hiphop. Next we will use superb fairy wrens to illustrate how to conduct single parent assignment of the sires. Finally, we will also use the same dataset to illustrate how to perform parent-pair analyses for the second case (by ignoring the fact that in superb fairy wrens we know the genetic mother a priori).</p>
<div id="individuals-dataframe" class="section level3">
<h3>individuals dataframe</h3>
<p>The dataset consist of two dataframes/files. The first input dataframe -called ‘individuals’- consists of a list of 1153 offspring that we would like to assign parentage to and 1373 records of potential parents (252 adult males and 145 adult females). The file has 5 variables:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>individuals[<span class="dv">23</span><span class="op">:</span><span class="dv">33</span>,]</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">#&gt;        brood  individual         type social.parent year</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">#&gt; 23 awRM_6299 899972-rnWR   adult male             1 2014</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">#&gt; 24 awRM_6299 982804-awRM adult female             1 2014</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">#&gt; 25 awRM_6299 A58115-NAgn    offspring             0 2014</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">#&gt; 26 awRM_6299 A58116-GMgn    offspring             0 2014</span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; 27 awRM_6299 A58117-OYgn    offspring             0 2014</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt; 28 awRM_6300 899972-rnWR   adult male             1 2014</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt; 29 awRM_6300 982045-BwgW   adult male             0 2014</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; 30 awRM_6300 982804-awRM adult female             1 2014</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; 31 awRM_6300 A58166-MObw    offspring             0 2014</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; 32 awRM_6300 A58167-YRbw    offspring             0 2014</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; 33 awRM_6300 A58168-AGbw    offspring             0 2014</span></span></code></pre></div>
<p>The first variable denotes the brood to which the individual belongs, the second variable is the identity of the individual, the third variable (type) denotes whether it is an offspring, adult male (i.e. a potential sire) or adult female (potential dam). The fifth column (social.parent) describes whether the individual is a social parent at the brood it is associated with (for females 1, if she incubated or build the nest; for males 1, if he was the dominant male pair bonded with the social mother) or not (0; supernumerary males). The final variable (year) is to separate cohorts to be analyzed. Note that parentage analyses is done typically done one cohort at a time, as the set of potential dams and sires will vary across years (as some individuals were not born yet or were already dead in some years).</p>
<p>Thus individuals may appear in multiple years and adults may also appear multiple times within a year if they were involved in multiple broods. For example, the above 10 records show two broods of the same breeding pair (982804-awRM &amp; 899972-rnWR). Both broods produced three offspring, but the second brood had a supernumerary male (982045-BwgW) helping the parents.</p>
<p>It is important to realise that there will usually be potential parents living both within and outside the study area that will not be considered if just the adults associated with a brood are included in this file. Cockburn et al. showed that some young are sired by males living outside the study area, and in other species floaters might be important. A universal problem will be parents living within the study area that do not raise young to the point where DNA can be sampled. Ensuring that such adults are considered as parents can be achieved by giving them a dummy brood ID. As can be seen below, in our dataset we have added such males using brood values such as other353, etc.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">tail</span>(individuals)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt;         brood  individual       type social.parent year</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; 2521 other353 899575-wbMM adult male             0 2015</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; 2522 other354 899575-wbMM adult male             0 2017</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; 2523 other355 899575-wbMM adult male             0 2018</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; 2524 other356 A58484-sOnr adult male             0 2015</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt; 2525 other357 A58484-sOnr adult male             0 2017</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt; 2526 other358 A58484-sOnr adult male             0 2018</span></span></code></pre></div>
<p>In some mating systems it will not be possible to separate the young into broods and there is no parental care. In such cases all young and potential parents can be given the same brood ID (with brood potentially meaning day of sampling, frog pond, fish tank). We note that the brood ID is not used for calculating the exclusion scores, it is only used to qualify any potential parent as either within- or extra-group (i.e. extra-brood) parent.</p>
</div>
<div id="genotypes-dataframe" class="section level3">
<h3>genotypes dataframe</h3>
<p>The second input dataframe/file -called ‘genotypes’- consists of a list of all genotyped individuals (offspring and potential parents) and their genotypes scored using bi-allelic markers. In the example dataset it comprises 1407 individuals scored at 1376 loci.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>genotypes[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]  </span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;             L545 L1022 L232 L696 L829 L1218 L7 L160 L857 L1475 L27 L495 L1100</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; 898377-onWA    0     2    0    0    2     2  2    2    2     2   0    2     2</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; 898797-YweY    0     2    0    2    2     0  0    2    2     0   2    2     0</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; 899199-OgoY    0     2    0    0    0     2  2    0    2     0   0    2     0</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; 899484-NybR    0     0    0    0    0     2  0    1    0     0   0    2     0</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt; 899575-wbMM    0     2    0    0    2     2  2    1    2     0   0    1     2</span></span></code></pre></div>
<p>The column names are alphanumerics used to identify each SNP (Single Nucleotide Polymorphism) and the row names identify each individual. Values are specified as follows:</p>
<ul>
<li>0 - homozygous for one allele (usually the common allele, but this is not necessary)</li>
<li>1 - homozygous for the alternative allele</li>
<li>2 - heterozygous at this locus</li>
<li>NA - a null result, where genotyping failed.</li>
</ul>
<p>If an individual was not sampled and/or genotyped it should not be included in the genotypes dataset.</p>
</div>
<div id="the-functions" class="section level3">
<h3>The functions</h3>
<p>R package hiphop only contains 3 functions: inspect, hothiphop and topmatch.</p>
<ol style="list-style-type: decimal">
<li>The inspect function is used for data inspection to detect any anomalies in genotypic data.</li>
<li>The hothiphop function calculates all the mismatch scores according to the HOT and HIPHOP test for all possible offspring-potential dam-potential sire combinations.</li>
<li>The topmatch function summarizes the best matches for each offspring according to the output of the hothiphop function. The default lists the top three offspring-potential dam-potential sire combinations that have the lowest mismatch score, and if social parents are specified, provides results for the social parents as well (if they are not ranked in the top three). Options defined below allow the sorting criterion to be varied, the number of triads listed to be increased and decreased, and the analysis conditioned on knowing one parent (for single parent assignment).</li>
</ol>
</div>
</div>
<div id="a-worked-example-to-illustrate-how-the-functions-work" class="section level2">
<h2>A worked example to illustrate how the functions work</h2>
<p>The hothiphop function extracts the list of potential dams and potential sires for a specific cohort of offspring from the individuals dataset. For that cohort it will consider all adult females listed that year as potential dams and all adult males listed that year as potential sires. For reasons given above, we analyse one cohort/year at a time.</p>
<div id="select-a-cohort" class="section level3">
<h3>select a cohort</h3>
<p>We thus first subset the individuals dataset to one cohort, here the 2018 cohort of superb fairy wrens.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>ind2018&lt;-<span class="kw">subset</span>(individuals, individuals<span class="op">$</span>year<span class="op">==</span><span class="dv">2018</span>)</span></code></pre></div>
</div>
<div id="inspect-the-data" class="section level3">
<h3>inspect the data</h3>
<p>Next we inspect the genotypes’ summaries and identify any individual that has not been genotyped:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>inspection&lt;-<span class="kw">inspect</span>(<span class="dt">ind=</span>ind2018, <span class="dt">gen=</span>genotypes)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">head</span>(inspection)</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt;      brood  individual         type social.parent year sampled homozygote.0</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; 1 other287 A58192-NBwr   adult male             0 2018       1    0.6337209</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; 2 other288 A58331-GNgn   adult male             0 2018       1    0.6446221</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; 3 other289 A58815-pOny   adult male             0 2018       1    0.6148256</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">#&gt; 4 other290 A58816-pWob   adult male             0 2018       1    0.6133721</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">#&gt; 5 other291 A58325-NNbw   adult male             0 2018       1    0.6286337</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; 6 other292 A58258-RNgn adult female             1 2018       1    0.6395349</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">#&gt;   homozygote.1 heterozygote.2     missing number.loci</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">#&gt; 1    0.1235465      0.2369186 0.005813953        1368</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">#&gt; 2    0.1220930      0.2311047 0.002180233        1373</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">#&gt; 3    0.1155523      0.2667151 0.002906977        1372</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">#&gt; 4    0.1170058      0.2652616 0.004360465        1370</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">#&gt; 5    0.1199128      0.2441860 0.007267442        1366</span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">#&gt; 6    0.1235465      0.2296512 0.007267442        1366</span></span>
<span id="cb7-17"><a href="#cb7-17"></a>inspection[<span class="kw">which</span>(inspection<span class="op">$</span>sampled<span class="op">==</span><span class="dv">0</span>),]</span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">#&gt;        brood  individual       type social.parent year sampled homozygote.0</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">#&gt; 41 fBab_7322 SOC018-fBab adult male             1 2018       0            0</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">#&gt;    homozygote.1 heterozygote.2 missing number.loci</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">#&gt; 41            0              0       1           0</span></span></code></pre></div>
<p>The summary lists, in addition to some details of the individual, the proportion of loci for which the individual is homozygous, heterozygous or has missing data. We see that most individuals have very few missing loci data (mostly &lt;1%), but that there is one social father (SOC018-fBab) that has not been sampled.</p>
</div>
<div id="calculate-the-mismatch-scores" class="section level3">
<h3>calculate the mismatch scores</h3>
<p>Next we run the mismatch analysis for all offspring-potential dam-potential sire combinations for the 2018 cohort using the hothiphop function. This function calculates the proportion of genetic mismatches according to the HIPHOP and HOT test.</p>
<p>In the 2018 cohort there are 149 offspring, 42 potential dams and 73 potential sires (each superb fairy wren brood has a social pair and 0-5 supernumerary adult males).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">length</span>(<span class="kw">unique</span>(ind2018<span class="op">$</span>individual[<span class="kw">which</span>(ind2018<span class="op">$</span>type<span class="op">==</span><span class="st">&quot;offspring&quot;</span>)])), <span class="kw">length</span>(<span class="kw">unique</span>(ind2018<span class="op">$</span>individual[<span class="kw">which</span>(ind2018<span class="op">$</span>type<span class="op">==</span><span class="st">&quot;adult female&quot;</span>)])), <span class="kw">length</span>(<span class="kw">unique</span>(ind2018<span class="op">$</span>individual[<span class="kw">which</span>(ind2018<span class="op">$</span>type<span class="op">==</span><span class="st">&quot;adult male&quot;</span>)]))))</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; [1] 149  42  73</span></span></code></pre></div>
<p>This means that there are about half a million possible combinations of offspring-dam-sire (149x42x73), so the next code may take several minutes to run:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>combinations&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span>ind2018, <span class="dt">gen=</span>genotypes)</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">head</span>(combinations)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt;   year    brood   offspring potential.dam potential.sire hothiphop.parents</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar   A58258-RNgn    A58192-NBwr               275</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar  A59012-zOogo    A58192-NBwr               242</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    A58110-BBW    A58192-NBwr               197</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar   A58954-fGny    A58192-NBwr               319</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; 5 2018 BBW_7279 A59401-iOar   A58908-fBab    A58192-NBwr               287</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; 6 2018 BBW_7279 A59401-iOar   A59232-cWar    A58192-NBwr               311</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt;   hiphop hot.parents hot.dam hot.sire hothiphop.dam hothiphop.sire</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; 1    122         153      72       99           194            221</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; 2    109         133      53       99           162            208</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; 3     90         107      17       99           107            189</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; 4    143         176     118       99           261            242</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; 5    135         152      87       99           222            234</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; 6    143         168      96       99           239            242</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt;   loci.dyad.dam loci.dyad.sire loci.triad offspring.heterozygosity</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">#&gt; 1          1356           1358       1349                0.2401171</span></span>
<span id="cb10-18"><a href="#cb10-18"></a><span class="co">#&gt; 2          1357           1358       1349                0.2401171</span></span>
<span id="cb10-19"><a href="#cb10-19"></a><span class="co">#&gt; 3          1355           1358       1347                0.2401171</span></span>
<span id="cb10-20"><a href="#cb10-20"></a><span class="co">#&gt; 4          1358           1358       1350                0.2401171</span></span>
<span id="cb10-21"><a href="#cb10-21"></a><span class="co">#&gt; 5          1362           1358       1354                0.2401171</span></span>
<span id="cb10-22"><a href="#cb10-22"></a><span class="co">#&gt; 6          1357           1358       1349                0.2401171</span></span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="co">#&gt;   social.mother.sampled social.father.sampled is.dam.social is.sire.social</span></span>
<span id="cb10-24"><a href="#cb10-24"></a><span class="co">#&gt; 1                     1                     1             0              0</span></span>
<span id="cb10-25"><a href="#cb10-25"></a><span class="co">#&gt; 2                     1                     1             0              0</span></span>
<span id="cb10-26"><a href="#cb10-26"></a><span class="co">#&gt; 3                     1                     1             1              0</span></span>
<span id="cb10-27"><a href="#cb10-27"></a><span class="co">#&gt; 4                     1                     1             0              0</span></span>
<span id="cb10-28"><a href="#cb10-28"></a><span class="co">#&gt; 5                     1                     1             0              0</span></span>
<span id="cb10-29"><a href="#cb10-29"></a><span class="co">#&gt; 6                     1                     1             0              0</span></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co">#&gt;   is.dam.within.group is.sire.within.group social.mother social.father</span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co">#&gt; 1                   0                    0    A58110-BBW   A58794-uWny</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="co">#&gt; 2                   0                    0    A58110-BBW   A58794-uWny</span></span>
<span id="cb10-33"><a href="#cb10-33"></a><span class="co">#&gt; 3                   1                    0    A58110-BBW   A58794-uWny</span></span>
<span id="cb10-34"><a href="#cb10-34"></a><span class="co">#&gt; 4                   0                    0    A58110-BBW   A58794-uWny</span></span>
<span id="cb10-35"><a href="#cb10-35"></a><span class="co">#&gt; 5                   0                    0    A58110-BBW   A58794-uWny</span></span>
<span id="cb10-36"><a href="#cb10-36"></a><span class="co">#&gt; 6                   0                    0    A58110-BBW   A58794-uWny</span></span></code></pre></div>
<p>This output is large and contains all the required information to assign parentage. Basically it lists all possible offspring-potential.dam-potential.sire combinations and their mismatch scores (unsorted), the number of loci this was based on, and some relevant information about the social parents and potential dam and sires. For a detailed explanation see the help file of the function (‘?hothiphop()’)</p>
</div>
<div id="summarize-the-best-matching-parents" class="section level3">
<h3>summarize the best matching parents</h3>
<p>However, due to the large number of combinations it can be difficult to find the salient information, so the results can be summarized into a more insightful format by extracting the top matches for each offspring using the ‘topmatch’ function. By default for each offspring the ‘topmatch’ returns the 3 top matches for male/female combinations according to the chosen ranking criteria, and additionally if they are not yet included, the results for the triad comprising the social parents.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>best.hothiphop&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>)</span>
<span id="cb11-2"><a href="#cb11-2"></a>best.hothiphop[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,]</span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt;   year    brood   offspring rank          dam         sire           dam.type</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1   A58110-BBW  A59058-zMyr      social parent</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    2   A58110-BBW   A59372-sOb      social parent</span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    3 A59012-zOogo  A59058-zMyr extra-group parent</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar   55   A58110-BBW  A58794-uWny      social parent</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">#&gt; 5 2018 BBW_7279 A59402-iMow    1   A58110-BBW  A59058-zMyr      social parent</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; 6 2018 BBW_7279 A59402-iMow    2   A58110-BBW A59201-cNbwb      social parent</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; 7 2018 BBW_7279 A59402-iMow    3   A58110-BBW   A59372-sOb      social parent</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; 8 2018 BBW_7279 A59402-iMow  120   A58110-BBW  A58794-uWny      social parent</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">#&gt;                  sire.type hothiphop.parents hiphop hot.parents hot.dam</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">#&gt; 1       extra-group parent                37      0          37      17</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">#&gt; 2       extra-group parent               109     43          66      17</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">#&gt; 3       extra-group parent               117     47          70      53</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">#&gt; 4            social parent               191    116          75      17</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">#&gt; 5       extra-group parent                33      1          32      18</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">#&gt; 6 within-group subordinate               104     62          42      18</span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">#&gt; 7       extra-group parent               112     58          54      18</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">#&gt; 8            social parent               201    133          68      18</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">#&gt;   hot.sire hothiphop.dam hothiphop.sire below.threshold threshold loci.dyad.dam</span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">#&gt; 1       20            17             20               1     99999          1355</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">#&gt; 2       53            60             96               1     99999          1355</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">#&gt; 3       20           100             67               1     99999          1357</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">#&gt; 4       70           133            186               1     99999          1355</span></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">#&gt; 5       14            19             15               1     99999          1356</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">#&gt; 6       28            80             90               1     99999          1356</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">#&gt; 7       42            76            100               1     99999          1356</span></span>
<span id="cb11-29"><a href="#cb11-29"></a><span class="co">#&gt; 8       63           151            196               1     99999          1356</span></span>
<span id="cb11-30"><a href="#cb11-30"></a><span class="co">#&gt;   loci.dyad.sire loci.triad offspring.heterozygosity social.mother.sampled</span></span>
<span id="cb11-31"><a href="#cb11-31"></a><span class="co">#&gt; 1           1355       1344                0.2401171                     1</span></span>
<span id="cb11-32"><a href="#cb11-32"></a><span class="co">#&gt; 2           1358       1347                0.2401171                     1</span></span>
<span id="cb11-33"><a href="#cb11-33"></a><span class="co">#&gt; 3           1355       1346                0.2401171                     1</span></span>
<span id="cb11-34"><a href="#cb11-34"></a><span class="co">#&gt; 4           1360       1349                0.2401171                     1</span></span>
<span id="cb11-35"><a href="#cb11-35"></a><span class="co">#&gt; 5           1356       1344                0.2660819                     1</span></span>
<span id="cb11-36"><a href="#cb11-36"></a><span class="co">#&gt; 6           1368       1356                0.2660819                     1</span></span>
<span id="cb11-37"><a href="#cb11-37"></a><span class="co">#&gt; 7           1361       1349                0.2660819                     1</span></span>
<span id="cb11-38"><a href="#cb11-38"></a><span class="co">#&gt; 8           1362       1350                0.2660819                     1</span></span>
<span id="cb11-39"><a href="#cb11-39"></a><span class="co">#&gt;   social.father.sampled social.mother social.father condition           ranking</span></span>
<span id="cb11-40"><a href="#cb11-40"></a><span class="co">#&gt; 1                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-41"><a href="#cb11-41"></a><span class="co">#&gt; 2                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-42"><a href="#cb11-42"></a><span class="co">#&gt; 3                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-43"><a href="#cb11-43"></a><span class="co">#&gt; 4                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-44"><a href="#cb11-44"></a><span class="co">#&gt; 5                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-45"><a href="#cb11-45"></a><span class="co">#&gt; 6                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-46"><a href="#cb11-46"></a><span class="co">#&gt; 7                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-47"><a href="#cb11-47"></a><span class="co">#&gt; 8                     1    A58110-BBW   A58794-uWny      none hothiphop.parents</span></span>
<span id="cb11-48"><a href="#cb11-48"></a><span class="co">#&gt;   ranking2</span></span>
<span id="cb11-49"><a href="#cb11-49"></a><span class="co">#&gt; 1     none</span></span>
<span id="cb11-50"><a href="#cb11-50"></a><span class="co">#&gt; 2     none</span></span>
<span id="cb11-51"><a href="#cb11-51"></a><span class="co">#&gt; 3     none</span></span>
<span id="cb11-52"><a href="#cb11-52"></a><span class="co">#&gt; 4     none</span></span>
<span id="cb11-53"><a href="#cb11-53"></a><span class="co">#&gt; 5     none</span></span>
<span id="cb11-54"><a href="#cb11-54"></a><span class="co">#&gt; 6     none</span></span>
<span id="cb11-55"><a href="#cb11-55"></a><span class="co">#&gt; 7     none</span></span>
<span id="cb11-56"><a href="#cb11-56"></a><span class="co">#&gt; 8     none</span></span></code></pre></div>
<p>For offspring A59401-iOar (the first four lines of output) we can see that the triad A58110-BBW (dam) &amp; A59058-zMyr (sire) has by far the fewest HOTHIPHOP.parents mismatches (37; HOTHIPHOP.parents = HOT score of the parents/triad + HIPHOP score of triad), much less than the second ranked dyad (109 mismatches; the same dam with another sire). The best ranked dam A58110-BBW is the social mother, while the best ranked sire A59058-zMyr is an extra-group parent (as it is not associated with the same brood as the offspring in the individuals dataset). In line 4 we can see that the social father also has many more mismatches (191), and is unlikely to be the sire. In rows 4-8 we see another offspring from the same brood, which in this case is sired by the same extra-group male A59058-zMyr (33 mismatches).</p>
</div>
<div id="options-to-summarize-the-best-matches-in-different-ways" class="section level3">
<h3>options to summarize the best matches in different ways</h3>
<p>It is possible to set a threshold value that determines whether the dam, sire or triad should be accepted as parents (see later for determining a threshold).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>best&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>, <span class="dt">thres=</span><span class="dv">62</span>)</span>
<span id="cb12-2"><a href="#cb12-2"></a>best[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">16</span>,<span class="dv">17</span>)]</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt;    year     brood   offspring rank         dam        sire      dam.type</span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt; 9  2018 fBab_7322 A59439-iMwr    1 A58908-fBab A58909-fMrn social parent</span></span>
<span id="cb12-5"><a href="#cb12-5"></a><span class="co">#&gt; 10 2018 fBab_7322 A59439-iMwr    2 A58908-fBab A59065-zOyb social parent</span></span>
<span id="cb12-6"><a href="#cb12-6"></a><span class="co">#&gt; 11 2018 fBab_7322 A59439-iMwr    3 A58908-fBab A58815-pOny social parent</span></span>
<span id="cb12-7"><a href="#cb12-7"></a><span class="co">#&gt; 12 2018 fBab_7322 A59439-iMwr   NA A58908-fBab        &lt;NA&gt; social parent</span></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co">#&gt;             sire.type hothiphop.parents below.threshold threshold</span></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="co">#&gt; 9  extra-group parent               163               0        62</span></span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="co">#&gt; 10 extra-group parent               164               0        62</span></span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="co">#&gt; 11 extra-group parent               165               0        62</span></span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="co">#&gt; 12      social parent                NA               0        62</span></span></code></pre></div>
<p>In our dataset, we found empirically that for this species and dataset (level of genotyping error) the true parents never had more than 62 HOTHIPHOP.parents mismatches (Cockburn et al.), and by setting the threshold to this value we can see that in the column ‘below.threshold’ all triads above (below) this value are labelled as 0 (1). If not specified, the default threshold value is a large value (99999) meaning that all triads are below the threshold.</p>
<p>If the threshold value is set to a value between 0 and 1 then the number of mismatches are recalculated to the proportion of mismatches (number of mismatches / number of loci that are not NA), which is a more accurate score if individuals differ strongly in the number of loci with missing data.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>best&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>, <span class="dt">thres=</span><span class="fl">0.045</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>best[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">16</span>,<span class="dv">17</span>)]</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt;    year     brood   offspring rank         dam        sire      dam.type</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; 9  2018 fBab_7322 A59439-iMwr    1 A58908-fBab A58909-fMrn social parent</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; 10 2018 fBab_7322 A59439-iMwr    2 A58908-fBab A59065-zOyb social parent</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; 11 2018 fBab_7322 A59439-iMwr    3 A58908-fBab A58815-pOny social parent</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; 12 2018 fBab_7322 A59439-iMwr   NA A58908-fBab        &lt;NA&gt; social parent</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">#&gt;             sire.type hothiphop.parents below.threshold threshold</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">#&gt; 9  extra-group parent         0.1202065               0     0.045</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">#&gt; 10 extra-group parent         0.1212121               0     0.045</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">#&gt; 11 extra-group parent         0.1216814               0     0.045</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">#&gt; 12      social parent                NA               0     0.045</span></span></code></pre></div>
<p>Finally, if the threshold value is set to a value between 0 and -1 then the number of mismatches are recalculated to the proportion of mismatches, but in contrast to above example the mismatch scores are expressed as the number of mismatched divided by the number of loci at which the offspring is heterozygote (for the HIPHOP test) or divided by number of loci at which the offspring is homozygote (for the HOT test). Thus, by setting ‘thres=-0.99’ we aim to correct for the fact that heterozygous offspring will accumulate more HIPHOP and less HOT mismatches, all else being equal. For calculating whether triads are below.threshold, they will be compared to abs(thres).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>best&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>, <span class="dt">thres=</span><span class="op">-</span><span class="fl">0.99</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a>best[<span class="dv">9</span><span class="op">:</span><span class="dv">12</span>,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">16</span>,<span class="dv">17</span>)]</span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt;    year     brood   offspring rank         dam        sire      dam.type</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">#&gt; 9  2018 fBab_7322 A59439-iMwr    1 A58908-fBab A59065-zOyb social parent</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">#&gt; 10 2018 fBab_7322 A59439-iMwr    2 A58908-fBab A58816-pWob social parent</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">#&gt; 11 2018 fBab_7322 A59439-iMwr    3 A58908-fBab A58815-pOny social parent</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">#&gt; 12 2018 fBab_7322 A59439-iMwr   NA A58908-fBab        &lt;NA&gt; social parent</span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">#&gt;             sire.type hothiphop.parents below.threshold threshold</span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">#&gt; 9  extra-group parent         0.2987475               1   (-)0.99</span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">#&gt; 10 extra-group parent         0.3118211               1   (-)0.99</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">#&gt; 11 extra-group parent         0.3159056               1   (-)0.99</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">#&gt; 12      social parent                NA               1   (-)0.99</span></span></code></pre></div>
<p>The ‘topmatch’ function can rank matches via several criteria specified by the parameter ‘ranking’. Options are: “hothiphop.parents” , “hiphop” ‘hot.dam’, ‘hot.sire’ as well as ‘hothiphop.dam’ and ‘hothiphop.sire’ (see ?topmatch() for explanation of how these criteria differ). For example:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>best.hiphop&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hiphop&quot;</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>best.hiphop[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt;   year    brood   offspring rank          dam        sire           dam.type</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1   A58110-BBW A59058-zMyr      social parent</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    2   A58110-BBW  A59372-sOb      social parent</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    3 A59012-zOogo A59058-zMyr extra-group parent</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar  449   A58110-BBW A58794-uWny      social parent</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt;            sire.type hothiphop.parents hiphop hot.parents hot.dam hot.sire</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; 1 extra-group parent                37      0          37      17       20</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; 2 extra-group parent               109     43          66      17       53</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; 3 extra-group parent               117     47          70      53       20</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt; 4      social parent               191    116          75      17       70</span></span></code></pre></div>
<p>At first glance, the HOTHIPHOP.parents scores may appear most informative as it sums all possible HIPHOP and HOT mismatches of the triad. However, the HOT test is disproportionately affected by genotyping error, and thus potentially HIPHOP can give cleaner comparisons in some cases than HOTHIPHOP.parents. As a result of above complexity (as well as other dependencies of HOT and HIPHOP scores on the rate of hetero- and homo-zygosity of the offspring and parents), the choice and best definition of exclusion criterion is not a trivial matter. Therefore, we refer to Cockburn et al. for a more in depth discussion of the pros and cons of different scoring criteria and how they can differ in their conclusions in parentage assignment.</p>
<p>We note that when ranking on the HOT test scores of dyads (e.g. on HOT.dam as shown below), that the top ranked triads will always contain the same dams (but with different sires), as the HOT.dam score -in contrast to the HIPHOP and HOT.parents score- is not calculated on a triad, but on an offspring-parent dyad and thus does not depend on the genotype of the other parent.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>best.hot.dam&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hot.dam&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>best.hot.dam[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]</span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">#&gt;   year    brood   offspring rank        dam        sire      dam.type</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1 A58110-BBW A58794-uWny social parent</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    2 A58110-BBW A58192-NBwr social parent</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    3 A58110-BBW A58331-GNgn social parent</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt;            sire.type hothiphop.parents hiphop hot.parents hot.dam hot.sire</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; 1      social parent               191    116          75      17       70</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt; 2 extra-group parent               197     90         107      17       99</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt; 3 extra-group parent               212     89         123      17      115</span></span></code></pre></div>
<p>To compare the HOT scores of dams it is necessary to specify that you are only interested in one record per dam, which can be achieved by setting the unique argument:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>best.hot.dam&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>best.hot.dam[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]</span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">#&gt;   year    brood   offspring rank          dam        sire           dam.type</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1   A58110-BBW A59058-zMyr      social parent</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    1   A58110-BBW A58794-uWny      social parent</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    2 A59012-zOogo A59058-zMyr extra-group parent</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar    3  A58258-RNgn A59058-zMyr extra-group parent</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">#&gt;            sire.type hothiphop.parents hiphop hot.parents hot.dam hot.sire</span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">#&gt; 1 extra-group parent                37      0          37      17       20</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">#&gt; 2      social parent               191    116          75      17       70</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">#&gt; 3 extra-group parent               117     47          70      53       20</span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">#&gt; 4 extra-group parent               144     59          85      72       20</span></span></code></pre></div>
<p>Now we get the top 3 unique dams ranked according to hot.dam score (as well as the social mother, if not in the top 3), and because we have also included a second ranking argument “hiphop” the dams are shown with the sires with whom they have the lowest hiphop score.</p>
<p>Furthermore, we can use the ‘condition’ parameter to also condition the parentage analysis on prior contextual knowledge of the parentage of one parent. In most species prior knowledge will relate to the social mother, as the fact that she is lactating, laid or incubated the eggs may provide such information (assuming e.g. egg dumping does not occur).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>best&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>, <span class="dt">condition=</span><span class="st">&quot;mother&quot;</span>)</span>
<span id="cb18-2"><a href="#cb18-2"></a>best[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]</span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">#&gt;   year    brood   offspring rank        dam         sire      dam.type</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1 A58110-BBW  A59058-zMyr social parent</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    2 A58110-BBW   A59372-sOb social parent</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    3 A58110-BBW A59201-cNbwb social parent</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar   38 A58110-BBW  A58794-uWny social parent</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">#&gt;                  sire.type hothiphop.parents hiphop hot.parents hot.dam</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">#&gt; 1       extra-group parent                37      0          37      17</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">#&gt; 2       extra-group parent               109     43          66      17</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">#&gt; 3 within-group subordinate               122     70          52      17</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">#&gt; 4            social parent               191    116          75      17</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">#&gt;   hot.sire</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">#&gt; 1       20</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">#&gt; 2       53</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">#&gt; 3       41</span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">#&gt; 4       70</span></span></code></pre></div>
<p>Now we can see that only the female that was classified as social parent is considered as dam, while all males are considered as potential sire. The conditioning on one parent will facilitate the assignment of the parentage of the other parent, unless the unconditioned parent is incorrect (see later on how to verify this assumption). For some specific species (e.g. with sex role reversal) one may instead want to condition on the social father instead.</p>
<p>Finally, it is possible to increase the number of combinations being ranked, by changing the value of the top parameter (the default is top=3, which shows the top 3 combinations plus the social parents). For example:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>best&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>, <span class="dt">top=</span><span class="dv">5</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a>best[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">7</span>]</span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">#&gt;   year    brood   offspring rank          dam         sire           dam.type</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1   A58110-BBW  A59058-zMyr      social parent</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    2   A58110-BBW   A59372-sOb      social parent</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    3 A59012-zOogo  A59058-zMyr extra-group parent</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar    4   A58110-BBW A59201-cNbwb      social parent</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">#&gt; 5 2018 BBW_7279 A59401-iOar    5  A58258-RNgn  A59058-zMyr extra-group parent</span></span>
<span id="cb19-9"><a href="#cb19-9"></a><span class="co">#&gt; 6 2018 BBW_7279 A59401-iOar   55   A58110-BBW  A58794-uWny      social parent</span></span></code></pre></div>
</div>
</div>
<div id="recommendations-for-the-two-different-type-of-parentage-analysis-cases" class="section level2">
<h2>Recommendations for the two different type of parentage analysis cases</h2>
<p>Previously we identified two types of cases in which paternity analysis can be conducted. Next we provide recommendations on how to proceed in such cases:</p>
<div id="parentage-assignment-when-one-genetic-parent-is-known-single-parent-analysis-1" class="section level3">
<h3>1. Parentage assignment when one genetic parent is known: single parent analysis</h3>
<p>The classical procedure is to first verify the assumption that the mother is known (using the HOT.dam criteria), and then condition on the social mother to determine the most plausible sire, which we can do with either the HOTHIPHOP.parents or HIPHOP criteria. Which of these two ranking score is most useful may depend on the amount of genotyping error and rates of hetero- and homo-zygosity in the population. The choice is thus largely an empirical question and it is useful to consider both scores (for more discussion see Cockburn et al.).</p>
<p>Thus we first compare the dams with the lowest HOT.dam scores to verify whether there were any cases in which the social mother has more mismatches than expected due to genotyping error.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>best.dams&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a>best.dams[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]</span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">#&gt;   year    brood   offspring rank          dam        sire           dam.type</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt; 1 2018 BBW_7279 A59401-iOar    1   A58110-BBW A59058-zMyr      social parent</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt; 2 2018 BBW_7279 A59401-iOar    1   A58110-BBW A58794-uWny      social parent</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; 3 2018 BBW_7279 A59401-iOar    2 A59012-zOogo A59058-zMyr extra-group parent</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; 4 2018 BBW_7279 A59401-iOar    3  A58258-RNgn A59058-zMyr extra-group parent</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; 5 2018 BBW_7279 A59402-iMow    1   A58110-BBW A59058-zMyr      social parent</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; 6 2018 BBW_7279 A59402-iMow    1   A58110-BBW A58794-uWny      social parent</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt; 7 2018 BBW_7279 A59402-iMow    2 A59012-zOogo A59058-zMyr extra-group parent</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; 8 2018 BBW_7279 A59402-iMow    3  A58258-RNgn A59058-zMyr extra-group parent</span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="co">#&gt;            sire.type hothiphop.parents hiphop hot.parents hot.dam hot.sire</span></span>
<span id="cb20-13"><a href="#cb20-13"></a><span class="co">#&gt; 1 extra-group parent                37      0          37      17       20</span></span>
<span id="cb20-14"><a href="#cb20-14"></a><span class="co">#&gt; 2      social parent               191    116          75      17       70</span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="co">#&gt; 3 extra-group parent               117     47          70      53       20</span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="co">#&gt; 4 extra-group parent               144     59          85      72       20</span></span>
<span id="cb20-17"><a href="#cb20-17"></a><span class="co">#&gt; 5 extra-group parent                33      1          32      18       14</span></span>
<span id="cb20-18"><a href="#cb20-18"></a><span class="co">#&gt; 6      social parent               201    133          68      18       63</span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="co">#&gt; 7 extra-group parent               122     53          69      61       14</span></span>
<span id="cb20-20"><a href="#cb20-20"></a><span class="co">#&gt; 8 extra-group parent               124     52          72      65       14</span></span>
<span id="cb20-21"><a href="#cb20-21"></a><span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.dams<span class="op">$</span>dam.type<span class="op">!=</span><span class="st">&quot;social parent&quot;</span>)</span>
<span id="cb20-22"><a href="#cb20-22"></a><span class="co">#&gt; integer(0)</span></span></code></pre></div>
<p>We see that in this cohort there were no cases where the social mother was not the first ranked dam (i.e. with lowest hot.dam score).</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>best.triad&lt;-best.dams[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span>),]</span>
<span id="cb21-2"><a href="#cb21-2"></a>best.triad&lt;-best.triad[<span class="op">!</span><span class="kw">duplicated</span>(best.triad[<span class="kw">c</span>(<span class="st">&quot;offspring&quot;</span>,<span class="st">&quot;dam&quot;</span>)]),] <span class="co">#we remove the duplicates, because if the dam with the lowest hot.dam score is the social mother she can be listed twice: once with the social father and one with the sire that gives the lowest HIPHOP score</span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="kw">plot</span>(best.triad<span class="op">$</span>hot.dam,best.dams<span class="op">$</span>hot.dam[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span>)], <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">xlab=</span><span class="st">&quot;Hot.dam score 1st ranked dams (here the social mothers)&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;Hot.dam score 2nd ranked dams&quot;</span>, <span class="dt">main=</span><span class="st">&quot;149 offspring of 2018 cohort&quot;</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="kw">abline</span>(<span class="dv">0</span>,<span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>We can also see that these first ranked dams, which we already confirmed were the social mothers, had lower HOT.dam scores than the second ranked dams, but we note that there is one case in which the 2nd ranked dam has a HOT.dam score of 29 mismatches, which is within the range of HOT.dam scores of social mothers. In such situations, which typically involves close relatives of the social mother, the HOTHIPHOP.parents or HIPHOP score provides additional information to distinguish the true dam, but only if the true sire is sampled.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>best.dams[<span class="kw">which</span>(best.dams<span class="op">$</span>offspring<span class="op">==</span><span class="st">&quot;A59419-iNgn&quot;</span>),<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>]</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt;    year     brood   offspring rank         dam        sire           dam.type</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; 17 2018 rgMM_7278 A59419-iNgn    1 982682-rgMM A59187-lNyn      social parent</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">#&gt; 18 2018 rgMM_7278 A59419-iNgn    1 982682-rgMM A59204-cGyn      social parent</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; 19 2018 rgMM_7278 A59419-iNgn    2 A30173-ngNA A59187-lNyn extra-group parent</span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">#&gt; 20 2018 rgMM_7278 A59419-iNgn    3 A30171-ynWA A59204-cGyn extra-group parent</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt;             sire.type hothiphop.parents hiphop hot.parents hot.dam hot.sire</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">#&gt; 17 extra-group parent                42      0          42      20       22</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">#&gt; 18      social parent               177     96          81      20       71</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">#&gt; 19 extra-group parent                68     20          48      29       22</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">#&gt; 20      social parent               205     85         120      67       71</span></span></code></pre></div>
<p>This output shows that although the 2nd ranked dam A30173-ngNA had a HOT.dam score close to that from the social mother 982682-rgMM (29 vs. 20), from the high HIPHOP score (20) it is clear she was not the genetic mother, but that the social mother was indeed the genetic mother (as she had 0 HIPHOP mismatches, which also indicates the true sire was sampled, as the HIPHOP score is calculated on a triad). Please note that first line of above ouput shows the social mother with the sire with whom she has the lowest HIPHOP score (in this case an extra-group sire), while the second line shows the social mother with the social father, which resulted in a many HIPHOP mismatches (96)</p>
<p>A more visual way of determining whether the social mother is also the genetic mother can be done by combining the above two steps in one plot. This approach is best illustrated on all cohorts. Below we provide the code to do this on all cohorts, but users can only run the 2018 cohort if this takes too long (if so, start at line with plot-function).</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="co"># first run the hothiphop on all cohorts</span></span>
<span id="cb23-2"><a href="#cb23-2"></a>comb<span class="fl">.18</span>&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span><span class="kw">subset</span>(individuals,individuals<span class="op">$</span>year<span class="op">==</span><span class="dv">2018</span>), <span class="dt">gen=</span>genotypes)</span>
<span id="cb23-3"><a href="#cb23-3"></a>comb<span class="fl">.17</span>&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span><span class="kw">subset</span>(individuals,individuals<span class="op">$</span>year<span class="op">==</span><span class="dv">2017</span>), <span class="dt">gen=</span>genotypes)</span>
<span id="cb23-4"><a href="#cb23-4"></a>comb<span class="fl">.16</span>&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span><span class="kw">subset</span>(individuals,individuals<span class="op">$</span>year<span class="op">==</span><span class="dv">2016</span>), <span class="dt">gen=</span>genotypes)</span>
<span id="cb23-5"><a href="#cb23-5"></a>comb<span class="fl">.15</span>&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span><span class="kw">subset</span>(individuals,individuals<span class="op">$</span>year<span class="op">==</span><span class="dv">2015</span>), <span class="dt">gen=</span>genotypes)</span>
<span id="cb23-6"><a href="#cb23-6"></a>comb<span class="fl">.14</span>&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span><span class="kw">subset</span>(individuals,individuals<span class="op">$</span>year<span class="op">==</span><span class="dv">2014</span>), <span class="dt">gen=</span>genotypes)</span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># then run topmatch function on all cohorts</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>best<span class="fl">.18</span>&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>comb<span class="fl">.18</span>, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb23-9"><a href="#cb23-9"></a>best<span class="fl">.17</span>&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>comb<span class="fl">.17</span>, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb23-10"><a href="#cb23-10"></a>best<span class="fl">.16</span>&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>comb<span class="fl">.16</span>, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb23-11"><a href="#cb23-11"></a>best<span class="fl">.15</span>&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>comb<span class="fl">.15</span>, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb23-12"><a href="#cb23-12"></a>best<span class="fl">.14</span>&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>comb<span class="fl">.14</span>, <span class="dt">ranking=</span><span class="kw">c</span>(<span class="st">&quot;hot.dam&quot;</span>,<span class="st">&quot;hiphop&quot;</span>), <span class="dt">unique=</span><span class="st">&quot;dam&quot;</span>)</span>
<span id="cb23-13"><a href="#cb23-13"></a><span class="co">#combine results</span></span>
<span id="cb23-14"><a href="#cb23-14"></a>combinations.all&lt;-<span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="kw">list</span>(comb<span class="fl">.18</span>, comb<span class="fl">.17</span>, comb<span class="fl">.16</span>,comb<span class="fl">.15</span>, comb<span class="fl">.14</span>))</span>
<span id="cb23-15"><a href="#cb23-15"></a>best.dams&lt;-<span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, <span class="kw">list</span>(best<span class="fl">.18</span>, best<span class="fl">.17</span>, best<span class="fl">.16</span>,best<span class="fl">.15</span>, best<span class="fl">.14</span>))</span>
<span id="cb23-16"><a href="#cb23-16"></a><span class="co">#remove the cases where the social mother was the first ranked dam, as then she is listed twice with rank 1</span></span>
<span id="cb23-17"><a href="#cb23-17"></a>best.triad&lt;-best.dams[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span>),]</span>
<span id="cb23-18"><a href="#cb23-18"></a>best.triad&lt;-best.triad[<span class="op">!</span><span class="kw">duplicated</span>(best.triad[<span class="kw">c</span>(<span class="st">&quot;offspring&quot;</span>,<span class="st">&quot;dam&quot;</span>)]),]</span>
<span id="cb23-19"><a href="#cb23-19"></a><span class="co"># plot the data</span></span>
<span id="cb23-20"><a href="#cb23-20"></a><span class="kw">plot</span>(best.triad<span class="op">$</span>hot.dam ,best.triad<span class="op">$</span>hiphop, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;HOT.dam&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;HIPHOP&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">120</span>))</span>
<span id="cb23-21"><a href="#cb23-21"></a><span class="kw">points</span>(best.dams<span class="op">$</span>hot.dam[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>best.dams<span class="op">$</span>dam.type<span class="op">!=</span><span class="st">&quot;social parent&quot;</span>)],best.dams<span class="op">$</span>hiphop[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st">  </span>best.dams<span class="op">$</span>dam.type<span class="op">!=</span><span class="st">&quot;social parent&quot;</span>)], <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb23-22"><a href="#cb23-22"></a><span class="kw">points</span>(best.dams<span class="op">$</span>hot.dam[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.dams<span class="op">$</span>dam.type<span class="op">!=</span><span class="st">&quot;social parent&quot;</span>)],best.dams<span class="op">$</span>hiphop[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.dams<span class="op">$</span>dam.type<span class="op">!=</span><span class="st">&quot;social parent&quot;</span>)], <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</span>
<span id="cb23-23"><a href="#cb23-23"></a><span class="kw">points</span>(best.dams<span class="op">$</span>hot.dam[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>best.dams<span class="op">$</span>dam.type<span class="op">==</span><span class="st">&quot;social parent&quot;</span>)],best.dams<span class="op">$</span>hiphop[<span class="kw">which</span>(best.dams<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st">  </span>best.dams<span class="op">$</span>dam.type<span class="op">==</span><span class="st">&quot;social parent&quot;</span>)], <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>)</span>
<span id="cb23-24"><a href="#cb23-24"></a><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;1st ranked social mother&quot;</span>, <span class="st">&quot;1st ranked not social mother&quot;</span>, <span class="st">&quot;2nd ranked social mother&quot;</span>, <span class="st">&quot;2nd ranked not social mother&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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lljV17G1MlvvYupJxqupJxmvpp5kvJp6kvFq6knGq6knGa+mnmS8mnqS8WrqScarqScZr6aeZLyaepLxaupJxqupJxmvpp5kvJp6kvFq6knGq6knGa+mnmS8mnqS8WrqScarqScZr6aeZLyaepLxaupJxqupJxmvpp5kvBbS/CAAd3et+9OI7jdN/Pi23IET3Dqyxd3GH1bGayEhXqcbfP76Mm/xz85YZLzukPFaSJDXhdCPb/NdlI3XcjJeCwny6m7E+zrHBoDX+20k/3Hn9WWOF359+fv9OTD38OH5gEb3J+O1kACvi686JwW83m8O/H6/8emd6PszNX59mR7NeNvc5Bll/ct4LaTpGbZ33XldvHK+2Xrgdf788unHx99+zJ+mO1svL2awGTJeCwn5q8JruCn6ON1A+3lOEV5MKRmvhZQTD7x6Xm9x7B///GK8rpbxWkg54y3vr55Q43WljNdCQvNZM3tsPmt57NSnH/PT/iweWC/jtZCyrhfMDxee/fXj29NX43WtjNdCkq/H3jXzOu9386/T43xeQGBgvObJeDX1JOPV1JOMV1NPMl5NPcl4NfUk49XUk4xXU08yXk09yXg19STj1dSTjFdTTzJeTT3JeDX1JOPV1JOMV1NPMl5NPcl4NfUk49XUk4xXU08yXk09yXg19STj1dSTjFdTTzJeTT3p/wG3m69VbCl/fwAAAABJRU5ErkJggg==" width="100%" /></p>
<p>Here we plotted the HOT.dam and HIPHOP score of the first and second ranked dam (ranked according to HOT.dam score, with the best matching sire according to the HIPHOP score) against their HIPHOP score. We also use different colors depending on whether they are the social mother or not. We see that that first ranked social mothers typically have both low HOT.dam and HIPHOP scores, while the occasional second ranked female with low HOT.dam scores (&lt;38 mismatches, within the range of social mothers) always had &gt;16 HIPHOP mismatches. Furthermore, we can also see that there are ~25 1st ranked social mothers with low HOT.dam scores but high HIPHOP scores, which we will discuss in the next section are situations where the sire was not sampled. Finally, even in the rare case when the social mother is not the first ranked dam on the HOT score (green dots; 5 out of 1153 offspring), she is still clearly identifiable as the genetic mother due to the low HIPHOP score (and non-social mothers that are ranked 1st on HOT.dam score always have high HIPHOP scores).</p>
<p>Above figure emphasizes that the HOT test in itself is thus insufficient to distinguish parentage among closely related individuals (as there were ~55 blue 2nd ranked triads of non-social mothers with HOT.dam scores similar to social mothers), but the HIPHOP (and HOTHIPHOP.parents) score is capable of doing so.</p>
<p>Once it is confirmed that the assumption that the social mother is always the dam is highly plausible, then we can condition on the mother and rank the sires, using either HIPHOP or HOTHIPHOP.parents scores.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>best.parents.hiphop&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations, <span class="dt">condition=</span><span class="st">&quot;mother&quot;</span>, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">plot</span>(best.parents.hiphop<span class="op">$</span>hiphop[<span class="kw">which</span>(best.parents.hiphop<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span>)],best.parents.hiphop<span class="op">$</span>hothiphop.parents[<span class="kw">which</span>(best.parents.hiphop<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span>)], <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;HIPHOP&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;HOTHIPHOP.parents&quot;</span>, <span class="dt">main=</span><span class="st">&quot;149 offspring of 2018 cohort&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">points</span>(best.parents.hiphop<span class="op">$</span>hiphop[<span class="kw">which</span>(best.parents.hiphop<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span>)],best.parents.hiphop<span class="op">$</span>hothiphop.parents[<span class="kw">which</span>(best.parents.hiphop<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span>)], <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;1st ranked&quot;</span>, <span class="st">&quot;2nd ranked&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>We can see that in many cases the best ranked triad has 0 or 1 mismatches for the HIPHOP test score, suggesting that the true sire is identified in this triad. In this case both the HIPHOP and HOTHIPHOP.parents score distinguish well between the true sires (1st ranked sires) and others (2nd ranked sires). We note that in the 2018 data under consideration, there were five outliers with high mismatch rates (the five red dots in the blue cloud).</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>best.parents.hiphop[<span class="kw">which</span>(best.parents.hiphop<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.parents.hiphop<span class="op">$</span>hiphop<span class="op">&gt;</span><span class="dv">20</span>),<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>,<span class="dv">22</span>,<span class="dv">23</span>)]</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">#&gt;    year     brood   offspring rank         dam        sire      dam.type</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">#&gt; 9  2018 fBab_7322 A59439-iMwr    1 A58908-fBab A58909-fMrn social parent</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">#&gt; 13 2018 fBab_7322 A59440-iOar    1 A58908-fBab A58484-sOnr social parent</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">#&gt; 21 2018 sNab_7237 A59620-hGwn    1 A59357-sNab A59045-zGab social parent</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">#&gt; 25 2018 sNab_7237  A59621-hYy    1 A59357-sNab  A59362-sBy social parent</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">#&gt; 29 2018 sNab_7237 A59622-hBgr    1 A59357-sNab A59041-zGgw social parent</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">#&gt;             sire.type hothiphop.parents hiphop hot.parents hot.dam hot.sire</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">#&gt; 9  extra-group parent               163     97          66      16       59</span></span>
<span id="cb26-10"><a href="#cb26-10"></a><span class="co">#&gt; 13 extra-group parent               170    119          51      14       48</span></span>
<span id="cb26-11"><a href="#cb26-11"></a><span class="co">#&gt; 21 extra-group parent               181     85          96      27       82</span></span>
<span id="cb26-12"><a href="#cb26-12"></a><span class="co">#&gt; 25 extra-group parent               157     71          86      29       69</span></span>
<span id="cb26-13"><a href="#cb26-13"></a><span class="co">#&gt; 29 extra-group parent               176     66         110      35       93</span></span>
<span id="cb26-14"><a href="#cb26-14"></a><span class="co">#&gt;    social.mother.sampled social.father.sampled</span></span>
<span id="cb26-15"><a href="#cb26-15"></a><span class="co">#&gt; 9                      1                     0</span></span>
<span id="cb26-16"><a href="#cb26-16"></a><span class="co">#&gt; 13                     1                     0</span></span>
<span id="cb26-17"><a href="#cb26-17"></a><span class="co">#&gt; 21                     1                     1</span></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co">#&gt; 25                     1                     1</span></span>
<span id="cb26-19"><a href="#cb26-19"></a><span class="co">#&gt; 29                     1                     1</span></span></code></pre></div>
<p>These five cases are from two broods. Three chicks from sNab_7237 had HIPHOP mismatches ranging from 66 to 85. The nest was close to the edge of the study area, and we believe it was sired by a foreign (unsampled) male. The second brood (fBab_7322) of two chicks also had high mismatches (97 &amp; 119); Cockburn et al. discuss this case in detail. The nest was close to the edge of the study area but the social father was unsampled (see 0 in column social.father.sampled), so in this case we cannot ascribe paternity, and also cannot say whether the chicks were within-pair or not.</p>
</div>
<div id="parentage-assignment-when-no-genetic-parents-are-known-parent-pair-analysis-1" class="section level3">
<h3>2. Parentage assignment when no genetic parents are known: parent pair analysis</h3>
<p>To illustrate the procedure for parent pair assignment (i.e. none of the genetic parents are known from contextual information), we again use the superb fairy wren dataset, but will now assume that we have no a priori information about the genetic mother and will focus on both maternity and paternity assignment. The superb fairy wren dataset only consist of offspring for which the true dam was sampled, which is unrealistic for many other study systems. To illustrate how to deal with situations of less complete sampling (also for the males), we removed 20% of the social mothers and 20% of the males from the individuals dataset.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>ff&lt;-<span class="kw">which</span>(individuals<span class="op">$</span>type<span class="op">==</span><span class="st">&quot;adult female&quot;</span>)</span>
<span id="cb27-2"><a href="#cb27-2"></a>individuals.rem&lt;-individuals[<span class="op">-</span>ff[<span class="kw">seq</span>(<span class="dv">5</span>,<span class="kw">length</span>(ff),<span class="dv">5</span>)],] <span class="co">#this removes every fifth female in the individuals dataframe</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>mm&lt;-<span class="kw">which</span>(individuals.rem<span class="op">$</span>type<span class="op">==</span><span class="st">&quot;adult male&quot;</span>)</span>
<span id="cb27-4"><a href="#cb27-4"></a>individuals.rem&lt;-individuals.rem[<span class="op">-</span>mm[<span class="kw">seq</span>(<span class="dv">5</span>,<span class="kw">length</span>(mm),<span class="dv">5</span>)],] <span class="co">#this removes every fifth male in the individuals dataframe</span></span></code></pre></div>
<p>When both social parents are unknown, the aims is to assign both maternity and paternity. The first step is to determine whether we get a clearly separated bi-modal distribution of HOTHIPHOP.parents or HIPHOP scores between the first ranked and higher ranked parents. Ideally this is done on a large dataset, so on all cohorts available (to skip the long run time, one could instead subset the individuals.rem dataframe below to the year 2018).</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>combinations.rem&lt;-<span class="kw">hothiphop</span>(<span class="dt">ind=</span>individuals.rem, <span class="dt">gen=</span>genotypes)</span>
<span id="cb28-2"><a href="#cb28-2"></a>best.hhhh&lt;-<span class="kw">topmatch</span>(<span class="dt">x=</span>combinations.rem, <span class="dt">ranking=</span><span class="st">&quot;hothiphop.parents&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3"></a>h1 &lt;-<span class="st"> </span><span class="kw">hist</span>(best.hhhh[<span class="kw">which</span>(best.hhhh<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span>), <span class="st">&quot;hothiphop.parents&quot;</span>], <span class="dt">breaks =</span> <span class="dv">100</span>)</span>
<span id="cb28-4"><a href="#cb28-4"></a>h2 &lt;-<span class="st"> </span><span class="kw">hist</span>(best.hhhh[<span class="kw">which</span>(best.hhhh<span class="op">$</span>rank<span class="op">==</span><span class="dv">2</span>), <span class="st">&quot;hothiphop.parents&quot;</span>], <span class="dt">breaks =</span> <span class="dv">50</span>)</span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="kw">plot</span>(h2, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">200</span>),  <span class="dt">xlab=</span><span class="st">&quot;HOTHIPHOP.parents&quot;</span>, <span class="dt">main=</span><span class="ot">NULL</span>)</span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="kw">plot</span>(h1, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">200</span>), <span class="dt">add =</span> T)</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;1st ranked&quot;</span>, <span class="st">&quot;2nd ranked&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> As case 2 concerns situations where the social parents are unknown, we have no information a priori whether the 1st ranked individuals are indeed the true dam-sire combinations, or whether due to genotyping error some of the true combinations ended up as 2nd or higher ranked. However from both histograms it is clear there is a bi-modal distribution, and in such situations we can make plausible assumptions that if only first ranked individuals are in the left peak that these are likely only true parents. Specifically, we see that there is a red peak at the left with low &lt;12 HIPHOP (or &lt;64 HOTHIPHOP.parents in left histogram) mismatch scores, which likely reflect the true dam-sire triads with mismatches due to genotyping error and mutations. In addition we have a blue peak with higher scores that are likely to reflect incorrect combinations, as these combinations have (much) higher mismatch scores (due to incompatible genotypes as well as genotyping error and mutations).</p>
<p>There are quite some red bars (1st ranked triads) within the peak of blue bars (2nd ranked triads). Based on above rationale it follows that these are incorrect 1st ranked combinations that may reflect cases where the true sire (and/or dam) was not sampled (in fact most of these are the offspring for which we removed the social mothers and sires at the start of this section). For these combinations we could look at the HOT.dam and HOT.sire scores to determine whether the sire or dam was likely to be unsampled (or both).</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">plot</span>(best.hhhh[<span class="kw">which</span>(best.hhhh<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.hhhh<span class="op">$</span>hiphop<span class="op">&lt;</span><span class="dv">12</span>),<span class="st">&quot;hot.dam&quot;</span>] ,best.hhhh[<span class="kw">which</span>(best.hhhh<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.hhhh<span class="op">$</span>hiphop<span class="op">&lt;</span><span class="dv">12</span>),<span class="st">&quot;hot.sire&quot;</span>], <span class="dt">col =</span><span class="st">&quot;orange&quot;</span> , <span class="dt">xlab=</span><span class="st">&quot;HOT.dam&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;HOT.sire&quot;</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">main=</span><span class="st">&quot;1st ranked triads (on HIPHOP) 2018 cohort&quot;</span>)</span>
<span id="cb29-2"><a href="#cb29-2"></a><span class="kw">points</span>(best.hhhh[<span class="kw">which</span>(best.hhhh<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.hhhh<span class="op">$</span>hiphop<span class="op">&gt;=</span><span class="dv">12</span>),<span class="st">&quot;hot.dam&quot;</span>] ,best.hhhh[<span class="kw">which</span>(best.hhhh<span class="op">$</span>rank<span class="op">==</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>best.hhhh<span class="op">$</span>hiphop<span class="op">&gt;=</span><span class="dv">12</span>),<span class="st">&quot;hot.sire&quot;</span>], <span class="dt">col =</span><span class="st">&quot;purple&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span> )</span>
<span id="cb29-3"><a href="#cb29-3"></a><span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">37</span>, <span class="dt">h=</span><span class="dv">35</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)</span>
<span id="cb29-4"><a href="#cb29-4"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="kw">c</span>(<span class="st">&quot;HIPHOP &lt; 12&quot;</span>, <span class="st">&quot;HIPHOP &gt;= 12&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;orange&quot;</span>, <span class="st">&quot;purple&quot;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> We have plotted the first ranked triads (according to HIPHOP score) for all 1153 offspring 2014-2018 cohorts. Based on above histograms, triads with HIPHOP scores lower than 12 (orange) are presumed to be the true parents, while triads with higher HIPHOP scores are assumed to be cases where at least one of the true parents was not sampled. From this figure we can see that true triads never have HOT.dam and HOT.sire scores higher than 37 and 35 respectively (see green lines in figure above), and we can use this information to identify which parent was unsampled.</p>
<ol style="list-style-type: decimal">
<li>The purple triads in the top left quadrant represents cases where the sire was unsampled.<br />
</li>
<li>The purple triads in the bottom right quadrant represents cases where the dam was unsampled.</li>
<li>The purple triads in the top right quadrant represents cases where we both the dam and sire were unsampled.</li>
<li>We can also see that there are four purple triads in the bottom left quadrant that have HOT.dam and HOT.sire scores that are similar to true dams and sires. This highlights again that HOT.dam and HOT.sire scores by themselves are not conclusive for assigning parentage in this dataset, because their HIPHOP scores were too high for them to be the true parents. These triads likely represent cases where either the true sire and/or true dam was unsampled, but instead a close relative was ranked first. Thus a high HOT.dam above the green threshold is evidence that the dam was unsampled, but a HOT.dam value below the threshold is not conclusive evidence that the true dam was sampled (same rationale holds for using HOT.sire to assign sires). This implies that for purple triads in the right two quadrants we can be certain the true dam was not sampled, but we cannot be certain that the sire in that triad was the true sire, as there is a small chance a closely related unsampled male was the true sire instead. Similarly, for purple triads in the top two quadrants we can be certain the true sire was not sampled, but we cannot be certain that the dam in that triad was the true sire, as there is a small chance a closely related unsampled female was the true dam. In situations where there would be no purple triads in the bottom left quadrant, we would be able to assign the parent even if one of the parents was unsampled.</li>
</ol>
<p>We end by noting that the parent-pair method we described above could also be used for the single parent assignment case for this dataset, but that in contrast to the single parent assignment approach described earlier it does not require one to look at HOT.dam scores:</p>
<ol style="list-style-type: decimal">
<li>We look at the histogram of HIPHOP (or HOTHIPHOP.parents) scores of 1st and 2nd ranked triads and determine if there are two peaks separated by a gap, which can be used to identify a threshold.</li>
<li>We identify all triads which have HIPHOP scores less than this threshold, for these triads we have identified the true sires and dams.</li>
<li>We check whether all dams in these triads identified in step 2 are social mothers.</li>
<li>If so, this means that all triads above the HIPHOP threshold in which the social mother was sampled must be cases where the sire was unsampled, while if the social mother was unsampled, we can not assign the sire with complete certainty in this dataset.</li>
</ol>
</div>
</div>
<div id="in-conclusion" class="section level2">
<h2>In conclusion</h2>
<p>The aim of the HIPHOP package/ approach is to exclude potential parents by determining if they have more mismatches than can be expected due to genotyping errors and mutation, and thereby identify (i) the true genetic parents and (ii) detect situations where one (or both) of the true parents is not sampled, in which case we (iii) want to identify which parent can still be correctly assigned. In this vignette we showed that both single parent and parent pair assignment based on HIPHOP or HOTHIPHOP.parents can assign genetic parents correctly, while this is not possible using only the HOT test. We can also identify offspring for which parent(s) were unsampled, but in this dataset we cannot with complete certainty identify a parent correctly if the other parent was not sampled (though if the sire (or dam) has a HOT.sire (HOT.dam) score in the range of what is typical for true sires (dams), we still have high certainty, but we just cannot exclude that a closely related unsampled parent may exist that was the true sire (or dam)). Assigning parents if one of the parents is not sampled, may be easier to do (i) in species that do not live among close relatives (superb fairy wrens have strong spatial genetic clustering due to their extreme male philopatry), (ii) if more loci are available for scoring, or (iii) if genotyping error is reduced, as the latter two may separate the HOT scores of true sires (or dams) from closely related sires (or dams) more clearly.</p>
</div>
<div id="troubleshooting" class="section level2">
<h2>Troubleshooting</h2>
<div id="asking-questions-suggesting-improvements-and-reporting-bugs" class="section level3">
<h3>Asking questions, suggesting improvements and reporting bugs</h3>
<p>Please post all queries to the R-hiphop google group at <a href="https://groups.google.com/d/forum/r-hiphop" class="uri">https://groups.google.com/d/forum/r-hiphop</a></p>
</div>
<div id="dealing-with-very-large-datasets" class="section level3">
<h3>Dealing with very large datasets</h3>
<p>The hothiphop function checks all possible offspring-potential.dam-potential.sire combinations. If the number of possible dams, sires and/or offspring is very large the number of combinations will become very high, which may lead to memory problems in R. In such cases a workaround is to limit the number of offspring in the individuals dataset to a smaller number (but still include all potential dams and sires). For example, one could include the first 10 offspring in the individuals file, run the hothiphop function, next run the hothiphop function for the next 10 offspring, and append the results to the results from the previous set (parallelization is another option).</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
